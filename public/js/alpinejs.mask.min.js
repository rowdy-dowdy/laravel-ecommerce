(()=>{function b(r){r.directive("mask",(e,{value:t,expression:u},{effect:s,evaluateLater:f})=>{let n=()=>u,o="";if(["function","dynamic"].includes(t)){let i=f(u);s(()=>{n=c=>{let p;return r.dontAutoEvaluateFunctions(()=>{i(a=>{p=typeof a=="function"?a(c):a},{scope:{$input:c,$money:k.bind({el:e})}})}),p},l(e)})}else l(e);e.addEventListener("input",()=>l(e)),e.addEventListener("blur",()=>l(e,!1));function l(i,c=!0){let p=i.value,a=n(p);if(!a||a==="false")return!1;if(o.length-i.value.length==1)return o=i.value;let g=()=>{o=i.value=d(p,a)};c?I(i,a,()=>{g()}):g()}function d(i,c){if(i==="")return"";let p=h(c,i);return v(c,p)}})}function I(r,e,t){let u=r.selectionStart,s=r.value;t();let f=s.slice(0,u),n=v(e,h(e,f)).length;r.setSelectionRange(n,n)}function h(r,e){let t=e,u="",s={"9":/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},f="";for(let n=0;n<r.length;n++){if(["9","a","*"].includes(r[n])){f+=r[n];continue}for(let o=0;o<t.length;o++)if(t[o]===r[n]){t=t.slice(0,o)+t.slice(o+1);break}}for(let n=0;n<f.length;n++){let o=!1;for(let l=0;l<t.length;l++)if(s[f[n]].test(t[l])){u+=t[l],t=t.slice(0,l)+t.slice(l+1),o=!0;break}if(!o)break}return u}function v(r,e){let t=Array.from(e),u="";for(let s=0;s<r.length;s++){if(!["9","a","*"].includes(r[s])){u+=r[s];continue}if(t.length===0)break;u+=t.shift()}return u}function k(r,e=".",t){if(/^\D+$/.test(r))return"9";t=t??(e===","?".":",");let u=(n,o)=>{let l="",d=0;for(let i=n.length-1;i>=0;i--)n[i]!==o&&(d===3?(l=n[i]+o+l,d=0):l=n[i]+l,d++);return l},s=r.replaceAll(new RegExp(`[^0-9\\${e}]`,"g"),""),f=Array.from({length:s.split(e)[0].length}).fill("9").join("");return f=u(f,t),r.includes(e)&&(f+=`${e}99`),queueMicrotask(()=>{this.el.value.endsWith(e)||this.el.value[this.el.selectionStart-1]===e&&this.el.setSelectionRange(this.el.selectionStart-1,this.el.selectionStart-1)}),f}document.addEventListener("alpine:init",()=>{window.Alpine.plugin(b)});})();
